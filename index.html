<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Favorite Movies</title>
  <!-- Linked Style Sheets -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- <link rel="stylesheet" href="assets/css/style.css">     Unique stylesheet -->
  <!-- <link rel="stylesheet" href="assets/css/style.css">      Meyerweb reset stylesheet -->

  <style type="text/css">
    button,
    div,
    form,
    input {
      margin: 10px;
    }
  </style>
</head>

<body>

  <div class="container">
    <h1>GifTastic</h1>

    <!-- Rendered Buttons will get Dumped Here  -->
    <div id="search-view"></div>

    <form id="gif-form">
      <label for="topic-input">Topic</label>
      <input type="text" id="topic-input">
      <label for="limit-input">Number</label>
      <input type="text" id="limit-input">
      <label for="rating-input">Rating</label>
      <input type="text" id="rating-input">
      <br>

      <!-- Button triggers new movie to be added -->
      <button id="add-gif" type="submit">Search for Gif</button>
    </form>
    <div class="row">
      <div class="col s12">
        <div id="gifResults">
          <div class="carousel">

          </div>
        </div>
      </div>
    </div>
    <!-- Gifs will Get Dumped Here -->
    <div id="gif-view"></div>

    <!-- Linked Script Sheets -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.0/umd/popper.min.js"></script>
    <script src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- Firebase Core JavaScript Link -->
    <script src="https://www.gstatic.com/firebasejs/6.0.4/firebase-app.js"></script>
    <!-- Specific Firebase products we want (Database) -->
    <script src="https://www.gstatic.com/firebasejs/6.0.4/firebase-database.js"></script>

    <script type="text/javascript">

      var gifApiKey = "pKiLNKQV2SjERLUPH7vMCwMB42eoCBYN";
      var topic = "";
      var gifLimit = 10;
      var gifRating = "r";
      // var gifURL = "https://api.giphy.com/v1/gifs/search?q=" + topic + "&api_key=" + gifApiKey + "&limit=" + gifLimit;
      var topics = ["Conan Obrien", "Awkward", "Excitied", "Drunk", "Mind Blown", "Halloween", "Tom Brady"];
      var topic = $("#topic-input").val().trim();
      // var gifLimit = $("#limit-input").val().trim();
      var gifRating = $("#rating-input").val().trim();


      $("#add-gif").on("click", function (event) {
        event.preventDefault();
        var topic = $("#topic-input").val().trim();
        var gifLimit = $("#limit-input").val().trim();
        var gifRating = $("#rating-input").val().trim();
        topics.push(topic);
        var gifURL = "https://api.giphy.com/v1/gifs/search?q=" + topic + "&api_key=" + gifApiKey + "&limit=" + gifLimit;

        $.ajax({
          url: gifURL,
          method: "GET"
        }).then(function (response) {
          console.log(response);
          var results = response.data;

          for (var i = 0; i < gifLimit; i++) {
            var gifDiv = $("<div class='gify'>");
            var p = $("<p>").text("Rating: " + results[i].rating);

            var gifImg = $("<img>");
            gifImg.attr("class","gif");
            gifImg.attr("src", results[i].images.fixed_height.url);
            gifImg.attr("data-still", results[i].images.fixed_height_still.url);
            gifImg.attr("data-animate", results[i].images.fixed_height.url);
            gifImg.attr("data-state","still");
            gifDiv.append(p, gifImg);
            $('#gifResults').prepend(gifDiv);
          }

        });
      });

      $(".gif").on("click", function() {
      var state = $(this).attr("data-state");
      if (state === "still") {
        $(this).attr("src", $(this).attr("data-animate"));
        $(this).attr("data-state", "animate");
      } else {
        $(this).attr("src", $(this).attr("data-still"));
        $(this).attr("data-state", "still");
      }
    });
    </script>
  </div>
</body>

</html>